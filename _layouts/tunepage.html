---
layout: default
---

<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
<h1 class="post-title" itemprop="name headline">{{ page.title }}</h1>
<p class="post-meta"> {{ page.key }} {{ page.mode }} {{ page.rhythm }}, added
  <time datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">{{ page.date | date: "%-d %B %Y" }}</time>
  <br />Played in: {{ page.location }}
</p>

{% assign titleTag = page.title | slugify | remove: '-' %}

{% if page.mp3_file %}
<!--Layout audioplayer at top of page if mp3 file is available-->
<form onsubmit="return false" oninput="level.value = flevel.valueAsNumber">
   <!-- declare an Audio Player for this page-->
   <audio id="OneAudioPlayer" loop>
       <source id="mp3Source" type="audio/mp3"></source>
       Your browser does not support the audio format.
   </audio>

   <div id="audioplayer{{ titleTag }}" title="{{ tune.title }}" class="audioplayer">
      <button id="pButton{{ titleTag }}" class="playButton"
         onclick="playAudio(audioplayer{{ titleTag }}, pButton{{ titleTag }}, playPosition, '{{ site.mp3_host }}{{ page.mp3_file }}',APos{{ titleTag }})">
        <div id="APos{{ titleTag }}" class="audioPos">0.0</div>
      </button>
      <input name="playPosition" id="playPosition" type="range" class="audio_control" min="0" max="400" value="0"
         oninput="adjustAudioPosition(value/400)" onchange="setAudioPosition(value/400, {{ titleTag }}B1, {{ titleTag }}B2)"/>
      <div class="speed_control">
         <span title="Adjust playback speed with slider">
            <input name="flevel" id="RS{{ titleTag }}" type="range" min="50" max="120" value="100"
               onchange="setPlaySpeed(audioplayer{{ titleTag }}, value/100)" />
            <output name="level">100</output>%
         </span>
      </div>
      <div class="loop_control">
         <span title="Play tune, select loop starting point, then select loop end point">
            <input type="button" id="{{ titleTag }}B1" value="Loop Start"
               onclick="SetPlayRange(audioplayer{{ titleTag }}, 0, {{ titleTag }}B1, {{ titleTag }}B2)" />
            <input type="button" id="{{ titleTag }}B2" value=" Loop End "
               onclick="SetPlayRange(audioplayer{{ titleTag }}, 1, {{ titleTag }}B1, {{ titleTag }}B2)" />
            <input type="button" value="Reset"
               onclick="SetPlayRange(audioplayer{{ titleTag }}, 2, {{ titleTag }}B1, {{ titleTag }}B2)" />
         </span>
      </div>
   </div>
</form>
{% else %}
<!-- build the abc player for each tune-->
<fieldset>
   <strong>No recording available - use the ABC player below the music to hear the tune</strong>
</fieldset>
{% endif %}

<script type="text/javascript" src="{{ site.mp3_host }}/js/musical-ws.js"></script>
<script type="text/javascript" src="{{ site.mp3_host }}/js/abc_controls.js"></script>
<script type="text/javascript" src="{{ site.mp3_host }}/js/audioplayer.js"></script>

<script type="text/javascript">
var MyFonts ="%%titlefont       Helvetica 20\n\
%%subtitlefont    Helvetica 16\n\
%%gchordfont      Helvetica 12\n\
%%composerfont    Helvetica-Oblique 14\n\
%%partsfont       Helvetica 12%%\n\
%%tempofont       Helvetica 12\n\
%%annotationfont  Helvetica 12\n\
%%infofont        Helvetica 12\n\
%%textfont        Helvetica 12\n\
%%vocalfont       Helvetica 12\n\
%%wordsfont       Helvetica 12\n";
var MyTune="%%staffwidth 540\n" + MyFonts + {{ page.abc | jsonify  }};
var MyABC = "<span class='showabc' style='font-size: 12px'><br />" + {{ page.abc | newline_to_br | jsonify }} + "</span>";

function toggle(button)
{
     switch(button.value)
     {
          case "Show ABC Source":
               button.value = "Hide ABC Source";
               document.getElementById('abcsource').innerHTML = MyABC;
               break;
          case "Hide ABC Source":
               button.value = "Show ABC Source";
               document.getElementById('abcsource').innerHTML = "";
               break;
     }
}
</script>


<div class="post-content" itemprop="articleBody">
   <div class="abc"><div id="notation"></div></div>

   {{ content }}

   {% unless page.mp3_file %}
   <fieldset><strong>A recording for this tune is not available yet. Qualify for glory by providing one!
   Make a recording of yourself or your session playing this tune and send it to us at admin@session.nz</strong></fieldset><br />
   {% endunless %}

   <h4>Play the ABC version</h4>

   <form onsubmit="return false" oninput="level.value = flevel.valueAsNumber">
      <div class="audioplayer">
         <button id="pButton" class="playButton"
            onclick="playABC(ABC, pButton, playPosition, RSABC{{ titleTag }}.value,ABCPos)">
            <div id="ABCPos" class="audioPos">0.0</div>
         </button>
         <input name="playPosition" id="playPosition" type="range" class="audio_control" min="0" max="500" value="0"
            oninput="setABCPosition(ABC, value/100)" />
         <div class="speed_control">
            <input name="flevel" id="RSABC{{ titleTag }}" type="range" min="50" max="120" value="100"
                onchange="changeABCspeed(ABC, pButton, value)">
            <output name="level">100</output>%
         </div>
      </div>
      <p class="clear"></p>
   </form>

   <form>
      <input type="button" value="Show ABC Source" onclick="toggle(this);">
   </form>

   <div id="abcsource"></div>
</div>

<textarea id="ABC" style="display:none;"></textarea>

<div class="attribution">
The audio for {{ page.title }} is sourced from <a href="{{ page.mp3_url }}">{{ page.mp3_source }}</a>.
Permission to use is gratefully acknowledged and the audio is made available under
this licence: {{ page.mp3_licence }}

{% if page.abc_source %}
The music notation was sourced from <a href="{{ page.abc_url }}">{{ page.abc_source }}</a>.
{% endif %}
</div>


<script>
$(document).ready(function() {
      RSABC{{ titleTag }}.value = 100; //initialise tune speed
      ABCJS.renderAbc('notation', MyTune);
      ABC.value = preProcessABC(MyTune);
});
</script>

</article>
