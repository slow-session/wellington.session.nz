---
layout: page
---
<!-- show tune info -->
<div class="row small-up-1 medium-up-2 large-up-2">
    <div class="small-6 columns">
        {{ page.key }} {{ page.rhythm }}, added
        <time datetime="{{ page.date | date_to_xmlschema }}">{{ page.date | date: "%-d %B %Y" }}</time>
        {% if page.location %}
        <br />Played in: {{ page.location }}
        {% endif %}
        {% if page.notes %}
        <p>Notes: {{ page.notes }}</p>
        {% endif %}
    </div>
    <div class="small-6 columns">
        {% if page.location contains 'Wellington' %}
        {% if page.slowtuneoftheweek %}
        Slow Session:
        <time datetime="{{ page.slowtuneoftheweek | date_to_xmlschema }}">{{ page.slowtuneoftheweek | date: "%-d %B %Y" }}</time>
        {% elsif page.tags contains 'slowsession' %}
        Slow Session: before 2017
        {% endif %}
        <br />
        {% endif %}
        {% if page.location contains 'Wellington' and page.regtuneoftheweek %}
        Regular Session:
        <time datetime="{{ page.regtuneoftheweek | date_to_xmlschema }}">{{ page.regtuneoftheweek | date: "%-d %B %Y" }}</time>
        <br />
        {% endif %}
    </div>
</div>
<br />

<!-- audio player for MP3 files-->
<div id="audioPlayer"></div>
<div style="overflow-x:auto;">
    <div id="showPlayer"></div>
</div>

<!-- preset loops -->
<form id="loopForm" style="display: none;">
    <input type="button" class="filterButton" value="Show Preset Loops" onclick="toggleLoops(this);">
</form>
<div id="loopPresetControls" style="display: none;"></div>

<!-- if there's ABC for the tune, display the dots, an ABC player and an ABC editor -->
<div>
    <!-- display the dots -->
    <div id="abcPaper" class="abcPaper"></div>

    {% if page.abc contains "K:" %}    
    <!-- play the ABC version -->
    <div style="overflow-x:auto;">
        <div id="ABCplayer"></div>
    </div>
        
    <!-- show/edit the ABC -->
    <form>
        <input type="button" class="filterButton" value="Show ABC Source" onclick="toggleABC(this);">
    </form>
    <div id='abcSource' class="abcSource">
        <textarea id="textAreaABC" class="abcText" rows="14" spellcheck="false"></textarea>
        <!-- show ABC errors -->
        <div id='abcWarnings'></div>
        
        <p>You can edit the ABC source, and see your changes. This will <b>NOT</b> change the website directly. A brief set of instructions is found    <a href="/editingABC/">here.</a>
        </p>

        <div title="Download the ABC you've entered. Don't lose your work!">
            <input value='Download ABC' type='button' class="filterButton" onclick='downloadABCFile(document.getElementById("textAreaABC").value)' />
        </div>
        <br />        
        <p>If you feel that your changes are a closer match to the recording on the website, please save your changes (<b>Download ABC</b> button), send them to us at <a href="mailto:{{ site.email }}">{{ site.email }}</a>, and we will review the proposed changes.
        </p>            
    </div>
{% endif %}

    <!-- attribution -->
    <div>
        <br />
        {% if page.mp3_file %}
        <p>The audio for {{ page.title }} is sourced from
        {% if page.mp3_url %}
        <a href="{{ page.mp3_url }}">{{ page.mp3_source }}</a>.
        {% else %}
        {{ page.mp3_source }}.
        {% endif %}
        Permission to use is gratefully acknowledged and the audio is made available under this licence:
        {{ page.mp3_licence }}</p>

        {% if page.mp3_url %}
        <p>Original audio: <a href="{{ page.mp3_url }}">{{ page.mp3_url }}</a></p>
        <!-- If the mp3_url is one from YouTube or Facebook, embed a copy here -->
        <p><script>
        show_iframe("{{ page.mp3_url }}");
        </script>
        </p>
        {% endif %}
        {% endif %}

        {% if page.alt_mp3_url %}
        <p>Alternative version: <a href="{{ page.alt_mp3_url }}">{{ page.alt_mp3_url }}</a></p>
        <!-- If the mp3_url is one from YouTube or Facebook, embed a copy here -->
        <p>
        <script>
        show_iframe("{{ page.alt_mp3_url }}");
        </script>
        </p>
        {% endif %}

        {% if page.abc_source %}
        <p>The music notation was derived from
        {% if page.abc_url %}
        <a href="{{ page.abc_url }}">{{ page.abc_source }}</a>.</p>
        {% else %}
        {{ page.abc_source }}
        {% endif %}
        {% endif %}
    </div>
</div>

{% assign tuneID = 1 %}
<script>

window.store = {
    "{{ tuneID }}": {
        "title": "{{ page.title | xml_escape }}",
        "tuneID": "{{ tuneID }}",
        "key": "{{ page.key | xml_escape }}",
        "rhythm": "{{ page.rhythm | xml_escape }}",
        "url": "{{ page.url | xml_escape }}",
        "mp3": "{{ site.mp3_host | append: page.mp3_file | xml_escape }}",
        "mp3_source": "{{ page.mp3_source | strip_html | xml_escape }}",
        "repeats": "{{ page.repeats }}",
        "parts": "{{ page.parts }}",
        "abc": {{ page.abc | jsonify }}
    },
};

$(document).ready(function() {
    let tuneID = "1";
    
    // create the ABC player
    audioPlayer.innerHTML = createAudioPlayer();
    
    {% if page.abc contains "K:" %}   
    // create the ABC player
    ABCplayer.innerHTML = createABCplayer("textAreaABC", tuneID, '{{ site.defaultABCplayer }}');
    createABCSliders("textAreaABC", tuneID);
    {% endif %}


    selectTune(window.store, tuneID);
    
    

});
</script>
