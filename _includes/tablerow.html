<!--build the first three columns-->
<td class="tuneTitle"><a href="{{ tune.url }}">{{ tune.title }}</a></td>
<td>{{ tune.key }}</td>
<td>{{ tune.rhythm }}</td>
{% if include.showSet %}
{% if tune.set %} {% assign tempSet = tune.set %} {% else %} {% assign tempSet = "none" %} {% endif %}
<td>{{ tempSet }}</td>
{% endif %}
{% if tune.mp3_file %}
<td id="showPlayer{{ include.tuneId }}">
<script>
var context = new AudioContext();

showPlayer{{ include.tuneId }}.innerHTML = createMP3player('{{ include.tuneId }}', '{{ site.mp3_host }}{{ tune.mp3_file }}', 'mp3player_tablerow');

// One-liner to resume playback when user interacted with the page
document.querySelector('button').addEventListener('click', function() {
    context.resume().then(() => {
        console.log('Playback button selected');
    });
});
</script>
</td>
{% else %}
<td id="showPlayer{{ include.tuneId }}">
<script>
var context = new AudioContext();

showPlayer{{ include.tuneId }}.innerHTML = createABCplayer('{{ include.tuneId }}', 'abcplayer_tablerow', '{{ site.defaultABCplayer }}');

// One-liner to resume playback when user interacted with the page
document.querySelector('button').addEventListener('click', function() {
    context.resume().then(() => {
        console.log('Playback button selected');
    });
});
</script>
</td>

<!--unroll ABC to handle repeats and different endings for parts-->
<script>
textAreas.innerHTML += '<textarea id="{{'ABC' | append: include.tuneId }}" style="display:none;">' + preProcessABC({{ tune.abc | jsonify }}) + '</textarea>';
</script>
{% endif %}
